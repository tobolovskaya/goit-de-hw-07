# goit-de-hw-07

## Apache Airflow DAG для обробки олімпійських медалей

Цей проект містить DAG для Apache Airflow, який виконує наступні завдання:

### Структура DAG

1. **create_table** - Створює таблицю `medal_counts` з полями:
   - `id` (AUTO_INCREMENT, PRIMARY KEY)
   - `medal_type` (VARCHAR(10))
   - `count` (INT)
   - `created_at` (TIMESTAMP)

2. **pick_medal_task** - Випадково обирає один з трьох типів медалей: Bronze, Silver, Gold

3. **Розгалуження на три завдання**:
   - **calc_Bronze** - Підраховує кількість бронзових медалей
   - **calc_Silver** - Підраховує кількість срібних медалей
   - **calc_Gold** - Підраховує кількість золотих медалей

4. **generate_delay** - Створює затримку на 35 секунд для тестування сенсора

5. **check_for_correctness** - Сенсор, який перевіряє, чи найновіший запис не старший за 30 секунд

### Особливості реалізації

- Використовується `BranchPythonOperator` для розгалуження логіки
- `MySqlOperator` для роботи з базою даних
- `SqlSensor` для перевірки свіжості даних
- `trigger_rule='one_success'` для завдання затримки
- Затримка 35 секунд спеціально створена для демонстрації роботи сенсора (який перевіряє 30-секундний інтервал)

### Налаштування

Перед запуском DAG переконайтеся, що:
1. Налаштовано з'єднання `mysql_default` в Airflow
2. Існує база даних `olympic_dataset` з таблицею `athlete_event_results`
3. Таблиця містить поле `medal` зі значеннями Bronze, Silver, Gold

### Запуск

DAG налаштований на щоденний запуск і може бути запущений вручну через веб-інтерфейс Airflow.